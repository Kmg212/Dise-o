<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kenedith Méndez - Gutiérrez">

<title>Modelos de regresión</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Guia4_RLR_files/libs/clipboard/clipboard.min.js"></script>
<script src="Guia4_RLR_files/libs/quarto-html/quarto.js"></script>
<script src="Guia4_RLR_files/libs/quarto-html/popper.min.js"></script>
<script src="Guia4_RLR_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Guia4_RLR_files/libs/quarto-html/anchor.min.js"></script>
<link href="Guia4_RLR_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Guia4_RLR_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Guia4_RLR_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Guia4_RLR_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Guia4_RLR_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
background: #005D0F;
      }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Modelos de regresión</h1>
            <p class="subtitle lead">Regresión lineal con R y RStudio</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kenedith Méndez - Gutiérrez </p>
            </div>
    </div>
      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenido</h2>
   
  <ul>
  <li><a href="#introducción." id="toc-introducción." class="nav-link active" data-scroll-target="#introducción."><span class="header-section-number">1</span> Introducción.</a></li>
  <li><a href="#descripción-del-problema" id="toc-descripción-del-problema" class="nav-link" data-scroll-target="#descripción-del-problema"><span class="header-section-number">2</span> Descripción del problema</a></li>
  <li><a href="#paso-1.-carguemos-los-datos." id="toc-paso-1.-carguemos-los-datos." class="nav-link" data-scroll-target="#paso-1.-carguemos-los-datos."><span class="header-section-number">3</span> Paso 1. Carguemos los datos.</a></li>
  <li><a href="#paso-2.-diágnostico-de-l-modelo." id="toc-paso-2.-diágnostico-de-l-modelo." class="nav-link" data-scroll-target="#paso-2.-diágnostico-de-l-modelo."><span class="header-section-number">4</span> Paso 2. Diágnostico de l modelo.</a>
  <ul class="collapse">
  <li><a href="#linealidad" id="toc-linealidad" class="nav-link" data-scroll-target="#linealidad"><span class="header-section-number">4.1</span> Linealidad</a></li>
  <li><a href="#comportamiento-de-los-datos." id="toc-comportamiento-de-los-datos." class="nav-link" data-scroll-target="#comportamiento-de-los-datos."><span class="header-section-number">4.2</span> Comportamiento de los datos.</a></li>
  <li><a href="#análisis-de-los-residuales." id="toc-análisis-de-los-residuales." class="nav-link" data-scroll-target="#análisis-de-los-residuales."><span class="header-section-number">4.3</span> Análisis de los residuales.</a>
  <ul class="collapse">
  <li><a href="#modelo-líneal" id="toc-modelo-líneal" class="nav-link" data-scroll-target="#modelo-líneal"><span class="header-section-number">4.3.1</span> Modelo líneal</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#paso-3.-inferencia-y-estimación-de-los-parámetros-de-los-modelos." id="toc-paso-3.-inferencia-y-estimación-de-los-parámetros-de-los-modelos." class="nav-link" data-scroll-target="#paso-3.-inferencia-y-estimación-de-los-parámetros-de-los-modelos."><span class="header-section-number">5</span> Paso 3. Inferencia y estimación de los parámetros de los modelos.</a></li>
  <li><a href="#paso-4.-opción-gráfica." id="toc-paso-4.-opción-gráfica." class="nav-link" data-scroll-target="#paso-4.-opción-gráfica."><span class="header-section-number">6</span> Paso 4. Opción Gráfica.</a></li>
  <li><a href="#paso-5.-tamaño-del-efecto-y-potencia." id="toc-paso-5.-tamaño-del-efecto-y-potencia." class="nav-link" data-scroll-target="#paso-5.-tamaño-del-efecto-y-potencia."><span class="header-section-number">7</span> Paso 5. Tamaño del efecto y potencia.</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introducción." class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introducción.</h1>
<p>Los modelos de regresión son un conjunto de técnicas estadísticas utilizadas para entender la relación entre una variable dependiente y una o más variables independientes. Este método permite predecir el comportamiento de la variable dependiente a partir de cambios en las variables independientes, siendo fundamental en diversas disciplinas como la economía, la biología y la ingeniería. Al aplicar un modelo de regresión sobre un conjunto de datos, se pueden identificar patrones y tendencias en los datos, facilitando la toma de decisiones informadas y la elaboración de estrategias basadas en evidencia. A través de su análisis, los investigadores pueden validar hipótesis y explorar cómo diferentes factores influyen en los resultados, lo que lo convierte en una herramienta esencial.</p>
<p>El modelo se define según el tipo de tendencia de los datos. A continuación se muestra la estructura de la creación del modelo en R para diferentes tendencia donde la variable de respuesta es <code>weight</code>y la variable predictora o independiente es <code>length</code>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Tendencia</th>
<th style="text-align: center;">Modelo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Líneal</td>
<td style="text-align: center;"><code>modelo&lt;-lm(weight~length, data = Datos)</code></td>
</tr>
<tr class="even">
<td style="text-align: center;">Exponencial</td>
<td style="text-align: center;"><code>modelo&lt;-lm(log(weight)~length, data = Datos)</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Potencia</td>
<td style="text-align: center;"><code>modelo&lt;-lm(log(weight)~log(length), data = Datos)</code></td>
</tr>
<tr class="even">
<td style="text-align: center;">logarítmica</td>
<td style="text-align: center;"><code>modelo&lt;-lm(weight~log(length), data = Datos)</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Cuadrática</td>
<td style="text-align: center;"><code>modelo&lt;-lm(weight~length+I(length^2), data = Datos)</code></td>
</tr>
</tbody>
</table>
</section>
<section id="descripción-del-problema" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Descripción del problema</h1>
<p>Se desea probar la efectividad de un nuevo fungicida para el control de roya en trigo. Se probaron distintas dosis en gramos del principio activo del producto por ha (gr.p.a./ha) en 13 parcelas de 100 plantas cada una. A los 15 días de la aplicación se realizó una evaluación del daño en términos del tamaño promedio de las machas en hoja bandera (Di Rienzo. Estadística para ciencias agropecuarias). Los resultados se muestran en la siguiente tabla:</p>
<hr>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Dosis</th>
<th style="text-align: center;">Daño</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">75</td>
<td style="text-align: center;">54</td>
</tr>
<tr class="even">
<td style="text-align: center;">275</td>
<td style="text-align: center;">30</td>
</tr>
<tr class="odd">
<td style="text-align: center;">50</td>
<td style="text-align: center;">58</td>
</tr>
<tr class="even">
<td style="text-align: center;">250</td>
<td style="text-align: center;">35</td>
</tr>
<tr class="odd">
<td style="text-align: center;">325</td>
<td style="text-align: center;">20</td>
</tr>
<tr class="even">
<td style="text-align: center;">350</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="odd">
<td style="text-align: center;">425</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">300</td>
<td style="text-align: center;">25</td>
</tr>
<tr class="odd">
<td style="text-align: center;">125</td>
<td style="text-align: center;">48</td>
</tr>
<tr class="even">
<td style="text-align: center;">100</td>
<td style="text-align: center;">50</td>
</tr>
<tr class="odd">
<td style="text-align: center;">200</td>
<td style="text-align: center;">39</td>
</tr>
<tr class="even">
<td style="text-align: center;">375</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="odd">
<td style="text-align: center;">400</td>
<td style="text-align: center;">5</td>
</tr>
</tbody>
</table>
</section>
<section id="paso-1.-carguemos-los-datos." class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Paso 1. Carguemos los datos.</h1>
<p>Generaremos dos vectores uno para cada variable independiente (X) bajo los nombres <strong>“Dosis”</strong> y otro para la variable dependiente (Y) bajo el nombre <strong>“Daño”</strong> y los agruparemos en un objeto de naturaleza tabla de datos bajo el nombre <strong>“A”</strong>.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Dosis<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">75</span>,<span class="dv">275</span>,<span class="dv">50</span>,<span class="dv">250</span>,<span class="dv">325</span>,<span class="dv">350</span>,<span class="dv">425</span>,<span class="dv">300</span>,<span class="dv">125</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">375</span>,<span class="dv">400</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Daño<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">54</span>,<span class="dv">30</span>,<span class="dv">58</span>,<span class="dv">35</span>,<span class="dv">20</span>,<span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">48</span>,<span class="dv">50</span>,<span class="dv">39</span>,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Dosis,Daño)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="paso-2.-diágnostico-de-l-modelo." class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Paso 2. Diágnostico de l modelo.</h1>
<p>Como el análisis de regresión lineal es una técnica parámetrica es necesario diágnosticar el modelo, en este caso linealidad entre X e Y, comportamiento de las variables, distribución normal de los residuales con media cero y variancia constante e independientes.</p>
<section id="linealidad" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="linealidad"><span class="header-section-number">4.1</span> Linealidad</h2>
<p>Para la linealidad realizaremos un gráfico de dispersión y así determinar de manera visual si los puntos se agrupan formando una linea recta:</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(A,<span class="fu">aes</span>(<span class="at">x =</span> Dosis,<span class="at">y =</span> Daño))<span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">20</span>,<span class="at">size=</span><span class="dv">4</span>,)<span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>,<span class="at">formula =</span> <span class="st">'y ~ x'</span>,<span class="at">method =</span> <span class="st">'loess'</span>)<span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Dosis del fungicida (g/ha)"</span>,<span class="at">y=</span><span class="st">"Aréa de la lesión de la roya en las hojas banderas"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Guia4_RLR_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comportamiento-de-los-datos." class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="comportamiento-de-los-datos."><span class="header-section-number">4.2</span> Comportamiento de los datos.</h2>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2); <span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  A <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Valor"</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">x =</span> Valor,<span class="at">fill=</span>Variable))<span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">5</span>, <span class="at">color=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Variable, <span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Frecuencia"</span>, <span class="at">x=</span><span class="st">"Valores de la variable"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Guia4_RLR_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="624"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitdistrplus)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>f.norm <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(A<span class="sc">$</span>Daño, <span class="st">"norm"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>f.lnorm <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(A<span class="sc">$</span>Daño, <span class="st">"lnorm"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>f.gamma <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(A<span class="sc">$</span>Daño, <span class="st">"gamma"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>f.pois <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(A<span class="sc">$</span>Daño, <span class="st">"pois"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>f.nbn <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(A<span class="sc">$</span>Daño, <span class="st">"nbinom"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>godfit<span class="ot">&lt;-</span><span class="fu">gofstat</span>(<span class="fu">list</span>(f.norm, f.lnorm, f.gamma, f.pois,f.nbn))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(godfit<span class="sc">$</span>chisq,godfit<span class="sc">$</span>chisqdf,<span class="fu">round</span>(godfit<span class="sc">$</span>chisqpvalue,<span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     [,1] [,2]     [,3]
1-mle-norm   8.698768e-01    1 0.350989
2-mle-lnorm  1.005139e+00    1 0.316070
3-mle-gamma  5.093846e-01    1 0.475405
4-mle-pois   2.649780e+04    2 0.000000
5-mle-nbinom 5.312564e-01    1 0.466079</code></pre>
</div>
</div>
</section>
<section id="análisis-de-los-residuales." class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="análisis-de-los-residuales."><span class="header-section-number">4.3</span> Análisis de los residuales.</h2>
<section id="modelo-líneal" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="modelo-líneal"><span class="header-section-number">4.3.1</span> Modelo líneal</h3>
<p>Realizaremos el análisis de los residuales donde verificaremos el ajuste a la distribución normal con la función <code>"shapiro.test()"</code> , homocedasticidad con la función <code>"bptest()"</code> ubicada en la libreria <code>"lmtest"</code> e independecia de los residuales del modelo con la función <code>"dwtest"</code> ubicada en la librería <code>"lmtest"</code>, para ello primero se debe crear el modelo y guardarlo en un objeto con el mismo nombre usando la función<code>"lm()"</code> de modelos lineales.</p>
<section id="creación-del-modelo" class="level4" data-number="4.3.1.1">
<h4 data-number="4.3.1.1" class="anchored" data-anchor-id="creación-del-modelo"><span class="header-section-number">4.3.1.1</span> Creación del modelo</h4>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>modelo<span class="ot">&lt;-</span><span class="fu">lm</span>(Daño<span class="sc">~</span>Dosis,<span class="at">data=</span>A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="supuestos-sobre-los-residuales." class="level4" data-number="4.3.1.2">
<h4 data-number="4.3.1.2" class="anchored" data-anchor-id="supuestos-sobre-los-residuales."><span class="header-section-number">4.3.1.2</span> Supuestos sobre los residuales.</h4>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalidad de los residuales.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo<span class="sc">$</span>residuals) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo$residuals
W = 0.88771, p-value = 0.09078</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Homocedasticidad-varianza constante.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(modelo) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modelo
BP = 0.42542, df = 1, p-value = 0.5142</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Independencia</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(modelo,<span class="at">alternative=</span><span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  modelo
DW = 2.3774, p-value = 0.5769
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráficas</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Guia4_RLR_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<p>Al realizar el análisis de los residuales del modelo, el test de normalidad shapiro &amp; wilks verificó un ajuste de los residuales del modelo a la distribución normal, <span class="math inline">\(\ W(13)=0.89, p=0.09\)</span>; además, el test de Breusch-Pagan corroboró que los residuales se distribuyen con varianza constante,<span class="math inline">\(\ BP(1)=0.42, p=0.51\)</span> y por último el test de Durbin - Watson arrojó que no existe autocorrelación significativa en los residuales de orden 1, <span class="math inline">\(\ DW=2.38, p=0.59\)</span>, por lo que desde el punto de vista estadístico podemos proceder con el análisis de regresión lineal para responder a la pregunta ¿Cuál es la relación que existe entre la dosis del fungicida y el daño foliar ocacionado por la roya de trigo en a hojas banderas? y contrastar las hipótesis, <span class="math inline">\(\ H_0:\)</span> No existe relación lineal entre la dosis del fungicida y el daño en ocacionado por la roya de trigo en la hojas banderas vs <span class="math inline">\(\ H_1:\)</span> Existe relación lineal entre la dosis del fungicida y el daño foliar ocacionado por la roya de trigo en la hojas banderas.</p>
</section>
</section>
</section>
</section>
<section id="paso-3.-inferencia-y-estimación-de-los-parámetros-de-los-modelos." class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Paso 3. Inferencia y estimación de los parámetros de los modelos.</h1>
<p>Para dar respuesta a nuestras hipótesis de contrastes en base a la información suministrada, usaremos la función <code>"summary()"</code> que nos permitirá observar la tabla de inferencia de los parámetros de nuestro modelo y así contrastar si los betas son diferentes de cero, de manera concreta para nuestro poblema tenemos:</p>
<p><strong>Para</strong> <span class="math inline">\(\beta_0\)</span> - Intercepto.</p>
<p><span class="math inline">\(\ H_0:\)</span> La recta pasa por el origen, es decir que el daño ocacionado por la roya en la hojas banderas de plántulas de trigo es cero sin aplicar el fungicida.</p>
<p><span class="math inline">\(\ H_1:\)</span> La recta no pasa por el origen, es decir que el daño ocacionado por la roya en la hojas banderas de plántulas de trigo es diferente de cero sin aplicar el fungicida.</p>
<p><strong>Para</strong> <span class="math inline">\(\beta_1\)</span> - Pendiente.</p>
<p><span class="math inline">\(\ H_0:\)</span> La pendiente es cero, es decir que la dosis del fungicida no influye de manera lineal en el daño ocasionado por la roya en la hojas banderas del trigo.</p>
<p><span class="math inline">\(\ H_1:\)</span> La pendiente es diferente de cero, es decir que la dosis del fungicida influye de manera lineal en el daño ocasionado por la roya en la hojas banderas del trigo.</p>
<p>Adicionalmente con la función <code>"cor.test()"</code> evaluaremos la significancia de la relación entre X e Y, y con la función <code>"confit()"</code> estimaremos el valor de cada uno de los parámetros del modelo por intervalos con un 95% de confianza. :::</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Daño ~ Dosis, data = A)

Residuals:
   Min     1Q Median     3Q    Max 
-2.864 -2.128 -1.137  1.778  5.231 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 67.033382   1.774572   37.77 5.41e-13 ***
Dosis       -0.149057   0.006363  -23.43 9.74e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.837 on 11 degrees of freedom
Multiple R-squared:  0.9804,    Adjusted R-squared:  0.9786 
F-statistic: 548.8 on 1 and 11 DF,  p-value: 9.737e-11</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> Dosis, <span class="at">y=</span>Daño,<span class="at">data=</span>A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  Dosis and Daño
t = -23.427, df = 11, p-value = 9.737e-11
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.9971316 -0.9663039
sample estimates:
       cor 
-0.9901267 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %     97.5 %
(Intercept) 63.1275757 70.9391878
Dosis       -0.1630606 -0.1350526</code></pre>
</div>
</div>
<p>El analisis de correlación reveló que existe una relación lineal significativa inversa fuerte entre la dosis del fungicida en (g/ha) y el daño foliar en las hojas banderas que ocaciona la roya en el trigo, <span class="math inline">\(\ t(11)=-23.43, p&lt;0.001, r=-0.99\)</span>. A su vez la prueba F arrojada por análisis de regresión determinó que es posible explicar con un modelo de regresión lineal el efecto de la dosis del fungicida sobre la magnitud del daño foliar que ocaciona la roya de trigo, <span class="math inline">\(\ F(1,11)=548.8, p&lt;0.001\)</span>, con un daño foliar significativo por defecto que se estima en <em>IC95%</em>[63.13 - 70.94], <span class="math inline">\(\ t(11)=37.77, p&lt;0.001\)</span>, y un efecto positivo del fungicida sobre el daño, donde por cada g/ha que aumenta la dosis se estima una disminución del daño foliar en <em>IC95%</em>[0.13: 0.16], <span class="math inline">\(\ t(11)=-23.43, p&lt;0.001\)</span>, teniendo así la siguiente ecuación para predecir el daño foliar en la hojas banderas con dosis de aplicación del fungicida entre 50 y 425 gr/ha con un ajuste del 98%, <span class="math inline">\(\widehat{Daño}=67.033-0.149*Dosis\)</span>.</p>
</section>
<section id="paso-4.-opción-gráfica." class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Paso 4. Opción Gráfica.</h1>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2);<span class="fu">library</span>(ggpubr)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(A,<span class="fu">aes</span>(<span class="at">x =</span> Dosis,<span class="at">y =</span> Daño))<span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">20</span>,<span class="at">size=</span><span class="dv">4</span>,)<span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">TRUE</span>,<span class="at">formula =</span> <span class="st">'y ~ x'</span>,<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>)<span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Dosis del fungicida (g/ha)"</span>,<span class="at">y=</span><span class="st">"Aréa de la lesión de la roya en las hojas banderas"</span>)<span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_regline_equation</span>(<span class="fu">aes</span>(<span class="at">label =</span>  <span class="fu">paste</span>(..eq.label.., ..adj.rr.label.., </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">sep =</span> <span class="st">"~~~~~"</span>)),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label.x =</span> <span class="dv">300</span>, <span class="at">label.y =</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Guia4_RLR_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="paso-5.-tamaño-del-efecto-y-potencia." class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Paso 5. Tamaño del efecto y potencia.</h1>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Efecto</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">omega_squared</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter | Omega2 |       95% CI
---------------------------------
Dosis     |   0.98 | [0.94, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#potencia</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.f2.test</span>(<span class="at">u =</span> <span class="dv">1</span>,<span class="at">v =</span> <span class="dv">11</span>, <span class="at">f2 =</span> <span class="fl">0.98</span>,<span class="at">sig.level =</span> <span class="fl">0.05</span>) <span class="co">#Retrospectiva</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Multiple regression power calculation 

              u = 1
              v = 11
             f2 = 0.98
      sig.level = 0.05
          power = 0.9004923</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.f2.test</span>(<span class="at">u =</span> <span class="dv">1</span>, <span class="at">f2 =</span> <span class="fl">0.98</span>,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">power =</span> <span class="fl">0.8</span>) <span class="co">#prospectiva</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Multiple regression power calculation 

              u = 1
              v = 8.333272
             f2 = 0.98
      sig.level = 0.05
          power = 0.8</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculo de n</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">9</span><span class="sc">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>